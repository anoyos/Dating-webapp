@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    var rating = Model.Count() > 0 ? Model.Average(x => x.rate) : 0;
}
@model List<james.Helpers.Custom.Api.EnRatingList>
<style>
    .bar-5 {
        width: @(Model.Count()>0? Math.Round(((double)Model.Where(x=>x.rate==5).Count()/ (double)Model.Count())*(double)100):0)%;
        height: 13px;
        background-color: #FBC02D;
        border-radius: 20px
    }

    .bar-4 {
        width: @(Model.Count()>0? Math.Round(((double)Model.Where(x=>x.rate==4).Count()/ (double)Model.Count())*(double)100):0)%;
        height: 13px;
        background-color: #FBC02D;
        border-radius: 20px
    }

    .bar-3 {
        width: @(Model.Count()>0? Math.Round(((double)Model.Where(x=>x.rate==3).Count()/ (double)Model.Count())*(double)100):0)%;
        height: 13px;
        background-color: #FBC02D;
        border-radius: 20px
    }

    .bar-2 {
        width: @(Model.Count()>0? Math.Round(((double)Model.Where(x=>x.rate==2).Count()/ (double)Model.Count())*(double)100):0)%;
        height: 13px;
        background-color: #FBC02D;
        border-radius: 20px
    }

    .bar-1 {
        width: @(Model.Count()>0? Math.Round(((double)Model.Where(x=>x.rate==1).Count()/ (double)Model.Count())*(double)100):0)%;
        height: 13px;
        background-color: #FBC02D;
        border-radius: 20px
    }
</style>
<div class="col-xl-9 col-lg-9 col-md-9 col-9 text-center mb-5">
    <div class="card">
        <div class="row justify-content-left d-flex">
            <div class="col-md-4 d-flex flex-column">
                <div class="rating-box">
                    <h1 class="pt-4 text-white">@rating</h1>
                    <p class="text-white">out of 5</p>
                </div>
                <div>
                    <span class="fa fa-star @(rating>=1?"star-active":"star-inactive")  mx-1"></span>
                    <span class="fa fa-star @(rating>=2?"star-active":"star-inactive") mx-1"></span>
                    <span class="fa fa-star @(rating>=3?"star-active":"star-inactive") mx-1"></span>
                    <span class="fa fa-star @(rating>=4?"star-active":"star-inactive") mx-1"></span>
                    <span class="fa fa-star @(rating>=5?"star-active":"star-inactive") mx-1"></span>
                </div>
            </div>
            <div class="col-md-8">
                <div class="rating-bar0 justify-content-center">
                    <table class="text-left mx-auto">
                        <tr>
                            <td class="rating-label">Excellent</td>
                            <td class="rating-bar">
                                <div class="bar-container">
                                    <div class="bar-5"></div>
                                </div>
                            </td>
                            <td class="text-right">@(Model.Where(x=>x.rate==5).Count())</td>
                        </tr>
                        <tr>
                            <td class="rating-label">Good</td>
                            <td class="rating-bar">
                                <div class="bar-container">
                                    <div class="bar-4"></div>
                                </div>
                            </td>
                            <td class="text-right">@(Model.Where(x=>x.rate==4).Count())</td>
                        </tr>
                        <tr>
                            <td class="rating-label">Average</td>
                            <td class="rating-bar">
                                <div class="bar-container">
                                    <div class="bar-3"></div>
                                </div>
                            </td>
                            <td class="text-right">@(Model.Where(x=>x.rate==3).Count())</td>
                        </tr>
                        <tr>
                            <td class="rating-label">Poor</td>
                            <td class="rating-bar">
                                <div class="bar-container">
                                    <div class="bar-2"></div>
                                </div>
                            </td>
                            <td class="text-right">@(Model.Where(x=>x.rate==2).Count())</td>
                        </tr>
                        <tr>
                            <td class="rating-label">Terrible</td>
                            <td class="rating-bar">
                                <div class="bar-container">
                                    <div class="bar-1"></div>
                                </div>
                            </td>
                            <td class="text-right">@(Model.Where(x=>x.rate==1).Count())</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>
    @foreach (var rate in Model)
    {
        <div class="card">
            <div class="row d-flex">
                <div class=""> <img class="profile-pic" src="/img/upload/@(rate.photo??"avatar.png")"> </div>
                <div class="d-flex flex-column">
                    <h3 class="mt-2 mb-0">@rate.name</h3>
                    <div>
                        <p class="text-left">
                            <span class="text-muted">@rate.rate</span>
                            <span class="fa fa-star @(rate.rate>=1?"star-active":"star-inactive")  mx-1"></span>
                            <span class="fa fa-star @(rate.rate>=2?"star-active":"star-inactive") mx-1"></span>
                            <span class="fa fa-star @(rate.rate>=3?"star-active":"star-inactive") mx-1"></span>
                            <span class="fa fa-star @(rate.rate>=4?"star-active":"star-inactive") mx-1"></span>
                            <span class="fa fa-star @(rate.rate>=5?"star-active":"star-inactive") mx-1"></span>
                            @*<span class="fa fa-star star-active ml-3"></span>
                                <span class="fa fa-star star-active"></span>
                                <span class="fa fa-star star-active"></span>
                                <span class="fa fa-star star-active"></span>
                                <span class="fa fa-star star-inactive"></span>*@
                        </p>
                    </div>
                </div>
                <div class="ml-auto">
                    <p class="text-muted pt-5 pt-sm-3">@rate.timestamp.ToString("dd MMM yyyy")</p>
                </div>
            </div>
            <div class="row text-left">
                @Html.Raw(rate.review)
            </div>

        </div>
    }

</div>