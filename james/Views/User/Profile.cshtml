@{
    Layout = "~/Views/Shared/_LayoutUser.cshtml";
}
@model james.Models.ViewModel.ProfileViewModel
@using james.Helpers.Custom;
@using james.Helpers.General;
@{
    var login = (tblLogin)ViewBag.login;
}
<style>

    .card {
        border-radius: 5px;
        background-color: #fff;
        padding-left: 60px;
        padding-right: 60px;
        margin-top: 30px;
        padding-top: 30px;
        padding-bottom: 30px;
        box-shadow: #cccccc85 0px 5px 20px !important;
    }

    .rating-box {
        width: 130px;
        height: 130px;
        margin-right: auto;
        margin-left: auto;
        background-color: #FBC02D;
        color: #fff
    }

    .rating-label {
        font-weight: bold
    }

    .rating-bar {
        width: 300px;
        padding: 8px;
        border-radius: 5px
    }

    .bar-container {
        width: 100%;
        background-color: #f1f1f1;
        text-align: center;
        color: white;
        border-radius: 20px;
        cursor: pointer;
        margin-bottom: 5px
    }



    td {
        padding-bottom: 10px
    }

    .star-active {
        color: #FBC02D;
        margin-top: 10px;
        margin-bottom: 10px
    }

        .star-active:hover {
            color: #F9A825;
            cursor: pointer
        }

    .star-inactive {
        color: #CFD8DC;
        margin-top: 10px;
        margin-bottom: 10px
    }

    .blue-text {
        color: #0091EA
    }

    .content {
        font-size: 18px
    }

    .profile-pic {
        width: 90px;
        height: 90px;
        border-radius: 100%;
        margin-right: 30px
    }

    .pic {
        width: 80px;
        height: 80px;
        margin-right: 10px
    }

    .vote {
        cursor: pointer
    }
</style>



<link href="/js/lightgallery/css/lightgallery.css" rel="stylesheet" />
<script src="/js/lightgallery/js/lightgallery-all.min.js"></script>
<div class="profile-page">
    @if (Model.me)
    {
        <div class="row mb-5">
            <div class="col-md-12">
                <p class="pull-left fn-size-18">This content on your profile is Public.</p>
                <a href="/user/index" class="btn btn-primary btn-gy pull-right">Exit View as</a>
            </div>
        </div>
    }

    <div class="row">

        <div class="col-md-12">
            <img src="~/Admin/Upload/images/pro-banner.png" />
            <div class="pro-dtl">
                <div class="row">
                    <div class="col-md-2">
                        <img class="cus" src="~/img/Upload/@(Model.profile.photo??"avatar.png")" />
                    </div>
                    <div class="col-md-4">
                        <div class="vac">
                            <img class="mr-3" src="~/Admin/Upload/icone/vac.png" />
                            <div>
                                <h4>Vaccine Status</h4>
                                <p class="color-black">@(Model.profile.vaccine??"N/A")</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <div class="col-md-2"></div>
        <div class="col-md-10 profile-wgit mb-3">
            <div class="pro-wgit">
                <h1 style=" margin-bottom: 5px; ">@Model.profile.name, @Model.profile.age</h1>
                <h4 style="font-weight:300">@Model.profile.profession</h4>
            </div>
            <div class="pro-wgit">
                <p class="test-green">
                    <img src="~/Admin/Upload/icone/online.png" />
                    Now online
                </p>
                <p class="color-black">
                    <img src="~/Admin/Upload/icone/home-icon.png" />
                    @Model.profile.city
                </p>
            </div>
            <div class="pro-wgit">
                <p class="text-primary">
                    <img src="~/Admin/Upload/icone/offline.png" />
                    New Member
                </p>
                <p class="color-black">
                    <img src="~/Admin/Upload/icone/pin.png" />
                    @Model.profile.distance KM
                </p>
            </div>
            <div class="pro-wgit">
                <p class="text-primary">
                    <img src="~/Admin/Upload/icone/star.png" />
                    @(Math.Round(Model.profile.rating,1)) rating
                </p>
                <p class="text-primary">
                    Received likes @Model.profile.likes
                </p>
            </div>
        </div>
        <div class="col-md-2"></div>
        <div class="col-md-10" style="padding-left:40px;">
            @if (Model.me)
            {
                <button class="btn mr-9 btn-primary btn-gy" href="#">Message</button>
                <button class="btn btn-primary btn-gy">Video Call</button>
            }
            else
            {
                <a class="btn mr-9 btn-primary btn-gy" href="/Messenger/Index">Message</a>
                <button class="btn btn-primary btn-gy btdialvideocall" data-photo="@Model.profile.photo" data-username="@Model.profile.name" data-userid="@Model.profile.id">Video Call</button>
            }
        </div>
    </div>

    <div class="row mt-7">
        <div class="col-md-12">
            <h3>@login.name was recently here.</h3>
            <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d924234.6301497458!2d66.59496105984819!3d25.193389485801205!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3eb33e06651d4bbf%3A0x9cf92f44555a0c23!2sKarachi%2C%20Karachi%20City%2C%20Sindh%2C%20Pakistan!5e0!3m2!1sen!2s!4v1658923715050!5m2!1sen!2s" width="100%" height="650" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
        </div>
    </div>
    <div class="row mt-7">
        <div class="col-md-12">
            <h3>Bio:</h3>
            <p class="color-black">
                @Html.Raw(Model.profile.aboutMe)
            </p>
        </div>
    </div>
    <div class="row mt-7">
        <div class="col-md-4 mb-5">
            <h4>Region:</h4>
            <button class="btn btn-primary btn-gy">@(Model.profile.religion??"N/A")</button>
        </div>
        <div class="col-md-4 mb-5">
            <h4>Looking for:</h4>
            <button class="btn btn-primary btn-gy">@(Model.profile.looking_for??"N/A")</button>
        </div>
        <div class="col-md-4 mb-5">
            <h4>Sexual:</h4>
            <button class="btn btn-primary btn-gy">@(Model.profile.sexualOrientation)</button>
        </div>
        <div class="col-md-4 mb-5">
            <h4>Profession:</h4>
            <button class="btn btn-primary btn-gy">@(Model.profile.profession??"N/A"))</button>
        </div>
        <div class="col-md-4 mb-5">
            <h4>Fetiches:</h4>
            <button class="btn btn-primary btn-gy">@(Model.profile.fetiches??"N/A")</button>
        </div>
        <div class="col-md-4 mb-5">
            <h4>Smoking:</h4>
            <button class="btn btn-primary btn-gy">@(Model.profile.smoke??"N/A")</button>
        </div>
        <div class="col-md-4 mb-5">
            <h4>Body Art:</h4>
            <button class="btn btn-primary btn-gy">@(Model.profile.physicalType??"N/A")</button>
        </div>
        <div class="col-md-4 mb-5">
            <h4> Childrens:</h4>
            <button class="btn btn-primary btn-gy">@(Model.profile.children??"N/A")</button>
        </div>
        <div class="col-md-4 mb-5">
            <h4>Relationship:</h4>
            <button class="btn btn-primary btn-gy">@(Model.profile.relationshipStatus??"N/A")</button>
        </div>
        <div class="col-md-4 mb-5">
            <h4>Education:</h4>
            <button class="btn btn-primary btn-gy">@(Model.profile.eduction??"N/A")</button>
        </div>
        <div class="col-md-12">
            <h4>My Hobbies:</h4>
            <div class="row">
                @foreach (var item in Model.profile.hobbies)
                {
                    <div class="col-md-4 mb-5">
                        <button class="btn btn-primary btn-gy">@item</button>
                    </div>
                }
            </div>
        </div>
        <div class="col-md-12">
            <h4>My Personality:</h4>
            <div class="row">
                @foreach (var item in Model.profile.personalities)
                {
                    <div class="col-md-4 mb-5">
                        <button class="btn btn-primary btn-gy">@item</button>
                    </div>
                }
            </div>
        </div>

        <div class="col-md-12">
            <h4>Qualities:</h4>
            <div class="row">
                @foreach (var item in Model.profile.qualities)
                {
                    <div class="col-md-4 mb-5">
                        <button class="btn btn-primary btn-gy">@item</button>
                    </div>
                }
            </div>
        </div>


        <div class="col-md-12 mt-5">
            @foreach (var item in Model.profile.albums.Where(x => x.images.Count() > 0))
            {
                <h4>@item.name</h4>


                <ul class="list-unstyled row lightgallery">


                    @foreach (var photo in item.images)
                    {
                        try
                        {

                            <li class="col-xs-6 col-sm-4 col-md-2" data-responsive="/img/upload/@(photo)" data-src="/img/upload/@photo">
                                <a href="#">
                                    <img src="/img/upload/@photo" />

                                </a>
                            </li>
                        }
                        catch (Exception ex)
                        {

                        }
                    }
                </ul>
                @*<div class="row">
                        @foreach (var photo in item.images)
                        {
                            <div class="col-md-2 mb-5">
                                <img src="/img/upload/@photo" />
                            </div>
                        }
                    </div>*@
            }
        </div>
        <br />
        <div class="col-md-12">
            <button type="button" class="btn btn-primary btprivatealbummodal">View Hidden Album</button>

        </div>
        @*<div class="col-md-12 mt-5">
                <h4>PHOTOS OF PLACES I'VE TRAVELED</h4>
                <div class="row">
                    <div class="col-md-2 mb-5">
                        <img src="~/Admin/Upload/images/m5.png" />
                    </div>
                    <div class="col-md-2 mb-5">
                        <img src="~/Admin/Upload/images/m6.png" />
                    </div>
                    <div class="col-md-2 mb-5">
                        <img src="~/Admin/Upload/images/m7.png" />
                    </div>
                    <div class="col-md-2 mb-5">
                        <img src="~/Admin/Upload/images/m8.png" />
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-2 mb-5">
                        <img src="~/Admin/Upload/icone/add-img.png" />
                    </div>
                </div>
            </div>


            <div class="col-md-12 mt-5">
                <h4>PICTURE OF MY PET OR MY HOBBIE</h4>
                <div class="row">
                    <div class="col-md-2 mb-5">
                        <img src="~/Admin/Upload/images/m9.png" />
                    </div>
                    <div class="col-md-2 mb-5">
                        <img src="~/Admin/Upload/images/m10.png" />
                    </div>
                    <div class="col-md-2 mb-5">
                        <img src="~/Admin/Upload/images/m11.png" />
                    </div>
                    <div class="col-md-2 mb-5">
                        <img src="~/Admin/Upload/images/m12.png" />
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-2 mb-5">
                        <img src="~/Admin/Upload/icone/add-img.png" />
                    </div>
                </div>
            </div>

            <div class="col-md-12 mt-5">
                <h4>PHOTOS: FAMILY, FRIENDS</h4>
                <div class="row">
                    <div class="col-md-2 mb-5">
                        <img src="~/Admin/Upload/images/m13.png" />
                    </div>
                    <div class="col-md-2 mb-5">
                        <img src="~/Admin/Upload/images/m14.png" />
                    </div>
                    <div class="col-md-2 mb-5">
                        <img src="~/Admin/Upload/images/m15.png" />
                    </div>
                    <div class="col-md-2 mb-5">
                        <img src="~/Admin/Upload/images/m16.png" />
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-2 mb-5">
                        <img src="~/Admin/Upload/icone/add-img.png" />
                    </div>
                </div>
            </div>*@

        <div class="col-md-12 mt-5">
            <h4>Write a Review:</h4>
            <div class="row">
                <div class="col-md-4 mb-5">
                    <button type="button" class="btn btn-primary btratingmodel">Add Review & Rating</button>
                </div>
            </div>
        </div>

    </div>



    <!-- Modal -->
    <div class="modal fade" id="ratingmodal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title" id="">Rating & Reviews</h3>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body  form-style--2">
                    <h3></h3>
                    <div class="col-lg-12 mb-5 ">
                        <div class="input-box">
                            <textarea class="form-control" rows="6" name="reviewtxt" placeholder="Typing..."></textarea>
                        </div>
                    </div>
                    <div class="col-lg-12 mb-3">
                        <div class="input-box">
                            <label>Ratings</label>
                            <div>
                                <span data-rate="1" class="btrate fa fa-star star-active mx-1"></span>
                                <span data-rate="2" class="btrate fa fa-star star-active mx-1"></span>
                                <span data-rate="3" class="btrate fa fa-star star-active mx-1"></span>
                                <span data-rate="4" class="btrate fa fa-star star-active mx-1"></span>
                                <span data-rate="5" class="btrate fa fa-star star-inactive mx-1"></span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary btn-2" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary btsubmitrating">Submit</button>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="px-1 py-5 mx-auto">
                <div class="row justify-content-center ratingpanel">

                </div>
            </div>
        </div>
    </div>
</div>




<!-- Button trigger modal -->
<!-- Modal -->
<div class="modal fade" id="privatealbummodal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            @*<div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>*@
            <div class="modal-body text-center">
                <h2 class="text-center">Verify Code</h2>
                <img src="~/Admin/icons/hide.jpg" class="mb-5" />
                <input class="form-control text-center" name="hiddenalbumcode" placeholder="Enter Code" type="password" />
                <br />
                <button class="btn-block btn-primary btn btsubmitcode">Submit Code</button>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.lightgallery').lightGallery();
        $('.lightgallery').on('onBeforeOpen.lg', function () {
            $('html').attr('data-dir', $('html').attr('dir'));
            $('html').attr('dir', 'ltr');
            $('.app-sidebar2').hide();
        })

        $('.lightgallery').on('onBeforeClose.lg', function () {
            $('html').attr('dir', $('html').attr('data-dir'));
            $('.app-sidebar2').show();
        })
        GetRating();
        $('.btratingmodel').on('click', function(){
            $('#ratingmodal').modal('show');
        })
        $('.btrate').on('click', function () {
            $('.btrate').removeClass('star-active').addClass('star-inactive')
            var rate = $(this).attr('data-rate') * 1;
            for (var i = 1; i <= rate; i++) {
                $('.btrate[data-rate="' + i + '"]').addClass('star-active').removeClass('star-inactive')
            }
        });
        $('.btsubmitrating').on('click', function () {

            var data = {
                rating: $('.btrate.star-active:last').attr('data-rate'),
                review: $('[name=reviewtxt]').val(),
                toUserId:@(Model.profile.id)
            };
            XHRPOSTRequest("/user/AddRating", { data: data }, function (result) {
                GetRating();
                $('#ratingmodal').modal('hide');
            });
        });

        $(document).on('click', '.btprivatealbummodal', function () {
            $('#privatealbummodal').modal('show');
        });
        $(document).on('click', '.btsubmitcode', function () {
            var code = $('[name=hiddenalbumcode]').val();
            if (code) {
                XHRPOSTRequest("/user/ApplyAlbumCode", { code: code, userId:@(Model.profile.id) }, function (result) {
                    if (result.Status == ResultStatus.Success) {
                        window.location.reload();
                    }
                    else {
                        showNotification(result.Message, "error")
                    }

                });
            }
        });



    });
    function GetRating() {
        $.ajax({
            url: "/user/GetRating?id=@Model.profile.id",
            type: "get",
            dataType: 'html',
            async: true,
            cache: false
        }).done(function (data) {
            $('.ratingpanel').html(data);
        }).always(function () { });
    }

</script>